sudo
====

極力rootユーザーでの操作を控えるため、sudoを使用します。

suの問題
--------

一般ユーザーがrootになるために次のコマンドを実行したとします。

    $ su

この場合、少し不都合な事が生じます。

rootのパスワードを入力している
------------------------------

サーバー管理は常にリモートアクセスを行っているので、このコマンドを入力した場合はroot権限のパスワードが漏えいしてしまう危険性が高まります。

sshで暗号化していてもできるなら避けたいものです。

suで実行したコマンドがhisitoryに残らない
----------------------------------------

いつ、だれがroot権限でそのコマンドを実行したのかを特定したい。

最小限のコマンドだけ利用できればいいのに全権限を付与されてしまう
----------------------------------------------------------------

もし、更衣室のロッカーの鍵を借りたいだけなのに社長室の鍵や金庫の鍵まで丸ごと貸し出しする管理をすると問題があると思います。

これらの問題を解決するため、sudoを導入します。

sudoがインストールされているかを確認
------------------------------------

パッケージ管理ツールであるyumを使って確認します。
installedとなっていればOKです。

    # yum list | grep sudo
    sudo.x86_64                                1.7.2p1-9.el5_5             installed

設定
----

visudo コマンドにpathが通っている事を確認します。

    # which visudo
    /usr/sbin/visudo

visudoを実行 

    # visudo

以下を追記します。 

    %agent ALL=(ALL) ALL

時間を節約するためパスワードの入力を省略できるようにする事もできます。

    %agent ALL=(ALL) NOPASSWD: ALL

ためしに一般ユーザーからsudo suが実行できるかを試してみます。
rootユーザーは#,一般ユーザーは$表示になっています。

    # su homepage
    $ sudo su
    # 

exitを実行すると一般ユーザー、もう一度exitを実行するとrootに戻ります。さらにもう一度exitを実行するとシェルが終了するはずです。

    # exit
    $ exit
    # eixt

初学者にとってはややわかりづらいのですが、そのうち慣れるのでここは気にしなくてよいでしょう。以降、一般ユーザーでログインを行います。

